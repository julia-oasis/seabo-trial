"use strict";var app=angular.module("seaboApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/collections",{templateUrl:"views/collections.html",controller:"CollectionsCtrl",controllerAs:"colls"}).when("/collections/:id",{templateUrl:"views/collection.html",controller:"CollectionCtrl",controllerAs:"coll"}).otherwise({redirectTo:"/"})}]),app.factory("ListsDataFactory",["$rootScope","$document","$http",function(a,b,c){var d={},e=function(b){var c={};c.title=b.title,c.thumbnail=b.identifier.value;var d=[],e=1;angular.forEach(b.listItem.slice(1),function(a){var b={};angular.forEach(a,function(a,c){if("externalWebsite"===c){if(b.title=a.title,b.id=e,angular.isArray(a.identifier)?b.url=a.identifier[0].value:b.url=a.identifier.value,b.url.match(/nuc\%3A([A-Z\%30-9\*]+)/)){var d=b.url.match(/nuc\%3A([A-Z\%0-9\*]+)/)[1];b.nuc=d.replace("%3A",":").replace("%5C","").replace("%29","").replace(":*","")}}else"note"===c&&(b.note=a,e++)}),d.push(b)}),a.collections=d};return d.getPromise=function(){console.log("Getting list...");var a=c.jsonp("http://api.trove.nla.gov.au/list/78794?encoding=json&reclevel=full&include=listItems&key=8dirgt7b3oj0vqd4&callback=JSON_CALLBACK",{cache:!0});return a},d.loadResources=function(b){a.repositories={VVCO:"Victorian Collections","SFU:SC":"Flinders University. Flinders University Library Special Collections",QPQ:"Unknown library code: QPQ",ANL:"National Library of Australia","VFED:IR":"Federation University Australia Library. FedUni Research Online",QSA:"Queensland State Archives","QUT:DC":"Queensland University of Technology. Digital Collections",VSWT:"Swinburne University of Technology. Swinburne Library","QU:IR":"University of Queensland. University of Queensland Library. University of Queensland: Institutional Repository",VSL:"State Library Victoria",QSL:"State Library of Queensland","APC:WC":"Australian Paralympic Committee. Images on Wikimedia Commons","NMMU:C":"Australian National Maritime Museum. Australian National Maritime Museum Collection",NWU:"University of Wollongong. University of Wollongong Library","VS:PUB":"CSIRO Publishing. scienceimage",QFSP:"Flinders Shire Council. Flinders Shire Council Historical Photograph Collection",YUF:"Flickr",XNLS:"Northern Territory Library ","VDU:IR":"Deakin University. Deakin University Library. Deakin University: Institutional Repository"},e(b.data.list[0])},d}]),app.filter("findById",function(){return function(a,b){for(var c=0;c<a.length;c++)if(+a[c].id===+b)return a[c]}}),angular.module("seaboApp").controller("MainCtrl",["$scope","$rootScope","$routeParams","$document","$filter","$http","$q","ListsDataFactory",function(a,b,c,d,e,f,g,h){d.scrollTop(0);var i=function(a,b){for(var c,d,e=a.slice(0),f=a.length;f--;)d=Math.floor((f+1)*Math.random()),c=e[d],e[d]=e[f],e[f]=c;return e.slice(0,b)},j=function(){var c=b.collections[Math.floor(Math.random()*b.collections.length)],d=c.url.match(/\?(.*)$/)[1];f.jsonp("http://api.trove.nla.gov.au/result?"+d+"&zone=picture&encoding=json&key=8dirgt7b3oj0vqd4&callback=JSON_CALLBACK",{cache:!0}).then(function(b){console.log(b);var c=b.data.response.zone[0].records.total;a.total=c;var e=[Math.floor(Math.random()*a.total)];c>100&&e>c-100&&(e=c-100),f.jsonp("http://api.trove.nla.gov.au/result?"+d+"&s="+e+"&n=100&zone=picture&encoding=json&key=8dirgt7b3oj0vqd4&callback=JSON_CALLBACK",{cache:!0}).then(function(b){var c=b.data.response.zone[0].records.work,d=i(c,24),e=[];angular.forEach(d,function(a){var b={};b.title=a.title,angular.forEach(a.identifier,function(a){"thumbnail"===a.linktype?b.thumbnail=a.value:"fulltext"===a.linktype&&(b.fulltext=a.value,"undefined"!=typeof a.linktext&&(b.linktext=a.linktext))}),e.push(b)}),a.images=e})}),a.collection=c};if("undefined"==typeof b.collections&&b.failed!==!0){var k=1,l=function(){var a=h.getPromise();a.then(function(a){h.loadResources(a),j()},function(){1>k?(k++,l()):b.failed=!0})};l()}else j()}]),angular.module("seaboApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("seaboApp").controller("CollectionsCtrl",["$scope","$rootScope","$routeParams","$document","$filter","$http","$q","ListsDataFactory",function(a,b,c,d,e,f,g,h){if(d.scrollTop(0),"undefined"==typeof b.collections&&b.failed!==!0){var i=1,j=function(){var a=h.getPromise();a.then(function(a){h.loadResources(a)},function(){1>i?(i++,j()):b.failed=!0})};j()}}]),angular.module("seaboApp").controller("CollectionCtrl",["$scope","$rootScope","$routeParams","$document","$filter","$http","ListsDataFactory",function(a,b,c,d,e,f,g){d.scrollTop(0);var h=function(a,b){for(var c,d,e=a.slice(0),f=a.length;f--;)d=Math.floor((f+1)*Math.random()),c=e[d],e[d]=e[f],e[f]=c;return e.slice(0,b)},i=function(){var d=e("findById")(b.collections,c.id);console.log(d);var g=d.url.match(/\?(.*)$/)[1];f.jsonp("http://api.trove.nla.gov.au/result?"+g+"&zone=picture&encoding=json&key=8dirgt7b3oj0vqd4&callback=JSON_CALLBACK",{cache:!0}).then(function(b){console.log(b);var c=b.data.response.zone[0].records.total;a.total=c;var d=[Math.floor(Math.random()*a.total)];c>100&&d>c-100&&(d=c-100),f.jsonp("http://api.trove.nla.gov.au/result?"+g+"&s="+d+"&n=100&zone=picture&encoding=json&key=8dirgt7b3oj0vqd4&callback=JSON_CALLBACK",{cache:!0}).then(function(b){var c=b.data.response.zone[0].records.work,d=h(c,48),e=[];angular.forEach(d,function(a){var b={};b.title=a.title,angular.forEach(a.identifier,function(a){"thumbnail"===a.linktype?b.thumbnail=a.value:"fulltext"===a.linktype&&(b.fulltext=a.value,"undefined"!=typeof a.linktext&&(b.linktext=a.linktext))}),e.push(b)}),a.images=e})}),a.collection=d};if("undefined"==typeof b.collections&&b.failed!==!0){var j=1,k=function(){var a=g.getPromise();a.then(function(a){g.loadResources(a),i()},function(){1>j?(j++,k()):b.failed=!0})};k()}else i()}]),angular.module("seaboApp").run(["$templateCache",function(a){a.put("views/about.html",'<p>Seabo is Trove’s serendipitous image browser which contains images that are known to be open access, out of copyright, shareable and reusable. </p> <p>These images can be reused and shared, so when you need an image to spruce up a presentation or to accompany a social media post you’ll be able to find something you can safely use without fear of breaching copyright. </p> <p>Simply browse for an image using our various links or if you’re feeling daring, click on ‘take me away Julio’ for a random image. Or you can use the search box to find something more specific. When you’ve found an image you want to use, simply download it and you’re away. We’d really like it if you could include a link back to the record in Trove.</p> <p>If you would like to see your organisation’s images to Seabo, please ensure you have a suitable rights statement in your records such as: <ul><li>‘All digitised images taken prior to 1955 and Out of Copyright’</li> <li>\'Copyright expired under Copyright Act 1968 Commonwealth of Australia\'</li> <li>\'Out of Copyright\'</li> <li>\'Copyright Expired\'</li> <li>\'No known copyright restrictions\'</li></ul> </p><p>Let the Trove team know when you’ve added a rights statement to your records and they will then be able to find all your images suitable for sharing in Seabo and add them to the application.</p> <p>If you have any questions about Seabo, <a href="http://librariesaustraliaref.nla.gov.au/reft100.aspx?pmi=UShyHU1Rve">contact the Trove team</a>. </p> <p></p> <p></p> <p><strong>DISCLAIMER</strong></p> <p>Members of Aboriginal, Torres Strait Islander and Maori communities are advised that Seabo contains names and images of deceased people. Seabo users should also be aware that certain words, terms or descriptions may be culturally sensitive and may be considered inappropriate today, but may have reflected the author\'s/creator\'s attitude or that of the period in which they were written.</p> <p></p> <p></p> <p><strong>Project Disclaimer</strong></p> <p>Seabo is a prototype application developed on a hack day by the Trove Support Team at the <a href="http://www.nla.gov.au/">National Library of Australia</a>. It uses the data made freely available to the world via the <a href="http://trove.nla.gov.au/">Trove API</a>. Please note that Seabo was a fun project to develop, a single-day experiment at other possible ways of diving into Trove’s images collections. Continuing development and enhancement of Seabo is not planned at this time. </p> <p>Seabo is not an official service developed or supported by the National Library of Australia. For a full experience you can go back to the source and <a href="http://trove.nla.gov.au/picture?q=">search the Pictures zone in Trove</a>, or browse the open collections in the <a href="http://trove.nla.gov.au/list?id=78794">Gif It Up Trove List</a>.</p> <p>You can find more about how the Trove Support team created Seabo by reading our blog post, <a href="http://www.nla.gov.au/blogs/trove/2015/12/17/hacking-trove">Hacking Trove</a>.</p>'),a.put("views/collection.html",'<div class="row marketing"> <h2>{{ repositories[collection.nuc] }}</h2> <p>{{ total }} images marked &lsquo;{{ collection.title }}&rsquo;</p> <p class="well" ng-bind-html="collection.note"></p> <div class="clearfix"> <a ng-href="{{ image.fulltext }}" class="pull-left" ng-repeat="image in images"> <img class="thumbnail center-cropped" ng-src="{{ image.thumbnail }}" alt="Thumbnail for {{ image.title }}"> </a> </div> </div>'),a.put("views/collections.html",'<div class="row marketing"> <h2>Drawing images from the following collections</h2> <ul> <li ng-repeat="collection in collections"> <a ng-href="#/collections/{{ collection.id }}">{{ repositories[collection.nuc] }} -- {{ collection.title }}</a> </li> </ul> </div>'),a.put("views/main.html",'<div class="jumbotron"> <h1>Welcome to Seabo!</h1> <p class="lead"> A gateway to open images in Trove. </p> </div> <div class="row loading text-muted" ng-hide="images"><p>Loading resources&hellip;</p></div> <div class="row marketing" ng-show="images"> <h2>Our featured collection</h2> <p><a href="#collections/{{ collection.id }}">{{ repositories[collection.nuc] }} has {{ total }} items marked {{ collection.title }}</a></p> <div class="clearfix"> <a ng-href="{{ image.fulltext }}" class="pull-left" ng-repeat="image in images"> <img class="thumbnail center-cropped" ng-src="{{ image.thumbnail }}" alt="Thumbnail for {{ image.title }}"> </a> </div> </div>')}]);